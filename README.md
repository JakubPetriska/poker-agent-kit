# poker-cfr

Python implementation of Counterfactual Regret Minimization for poker. 

Implementation makes heavy use of tools from [ACPC][1] poker infrastructure through Python wrapper which can be found [here][2]. Complete poker infrastructure is contained within the wrapper library, therefore to run code in this repo only the [ACPC python wrapper][2] library is needed. 

If you want to test the strategies generated by CFR implementation in this repo please first take the time to read about the architecture of ACPC [here][3].

**Current implementation only supports limit betting games**

## Prerequisites 
Code in this repo is using Python 3.6. No additional packages are required to run the code although it is recommended to install `tqdm` package for training progress information.

## CFR
The CFR implementation is contained in `cfr` module in root of the project. Example usage can be seen in script `train.py` also in the root of the project which given game definition file, number of iterations and strategy output file runs the CFR algorithm.

## Games
Example of files needed to train and test the agent can be found in directory *games*. Each subdirectory named by the game contains: 
* *{game_name}.game*: game definition file , 
* *agent_random.{game_name}.sh*: random agent script
* *agent_trained.{game_name}.sh*: agent using the produced strategy
* *agent_trained_weak.{game_name}.sh*: another agent using the produced strategy

Directory currently contains files for Kuhn poker for 2 players, Kuhn poker for 3 players and Leduc Hold'em for 2 players.

## Training
To run training for one games included in this repository run the `train.py` script. Example command for Leduc Hold'em looks like this:
```python
python train.py ./games/leduc.limit.2p/leduc.limit.2p.game 1000000 ./games/leduc.limit.2p/leduc.limit.2p.strategy
```
here `./games/leduc.limit.2p/leduc.limit.2p.game` is a path to game definition file, `1000000` is number of training iterations and `./games/leduc.limit.2p/leduc.limit.2p.strategy` is path to file into which the result strategy will be written.

## Agent
Module `agent` in the root of the project contains the agent which takes game definition file and generated strategy and plays the poker game through ACPC infrastructure.

## Testing the agent
Scripts `play_against_random.sh`, `play_against_weak.sh`, `start_dealer_and_player_1.sh` and `train_and_play_all.sh` allow you to test the produced agent in various modes and against various opponents. Please refer to the documentation in the scripts.

For example to test generated agent against random agent following command can be called:
```python
./play_against_random.sh games/kuhn.limit.2p/
```
where `games/kuhn.limit.2p/` is path to the directory containing the game files.

[1]: http://www.computerpokercompetition.org/
[2]: https://github.com/JakubPetriska/acpc-python-client
[3]: https://github.com/JakubPetriska/acpc-python-client/blob/master/acpc_infrastructure/README
